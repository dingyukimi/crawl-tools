#include<stdio.h>
#include<string.h>
int next[1000002],d;
char a[1000002];
void get_next()
{
    int i=1,j=0;
    next[1]=0;
    while(i<=d)
    {
        if(j==0||a[i]==a[j]) {i++;j++;next[i]=j;}
        else j=next[j];
    }
}
int main()
{
    int i,k,t=0,flag;
    while(1)
    {
        flag=1;
        memset(next,0,sizeof(next));
        scanf("%d",&d);
        if(d==0) return 0;
        scanf("%s",a+1);
        get_next();
        printf("Test case #%d\n",++t);
        // for(i=1;i<=d+1;i++)  printf("%d ",next[i]);
        // printf("\n");
        for(i=2;i<=d;i++)
        {
            k=i-(next[i+1]-1);
            /*next[i+1]-1æ¯i+1ä¹åçå¾ªç¯é¿åº¦      ç¨iä¸åå°±æ¯å©ä¸çé¿åº¦ å¦æå©ä¸çé¿åº¦ä¸ºä¸ä¸ªéå¤ä¸²çé¿åº¦
            åå¯ä»¥è¾åº  å¦åä¸è½è¾åº å¦ abcabcabc  next[10]-1=6 ç¨iä¸åï¼ç­äºä»abcabcabcä¸­æabcabcabcæ¿èµ°ï¼ 
            å©ä¸ä¸ª3ï¼å³abcï¼  iæ¯3çæ´æ°åï¼é¿ä¸²ç1å°içå­ä¸²ä¸­æ¯å¨ç±abcç»æï¼ æ­¤æ¶è½è¾åº
            next[9]-1=2 è¯´æå©ä¸çä¸å¤ä¸ä¸ªéå¤ä¸² å³ä¸è½è¢«iæ´é¤  ä¸è½è¾åº*/
            if(i!=k&&i%k==0)  printf("%d %d\n",i,i/k);//i==kæ¯æå¾ªç¯é¿åº¦ä¸º0 å³æ²¡æå¾ªç¯
        }
        printf("\n");
    }
    return 0;
}
/*éä¼åçnextæ°ç»çå«ä¹æ¯ï¼next[i]=kæ¨¡å¼ä¸²ä¸æ ä¸ºiçå­ç¬¦çåk-1ä¸ªå­ç¬¦ä¸å¼é¦çåk-1ä¸ªå­ç¬¦ç¸ç­
ä¾å¦ aabaabaab   next[10]=7 è¡¨ç¤ºä¸æ ä¸º10ä¹åçå­ç¬¦å6ä¸ªå­ç¬¦ ä¸å¼é¦çå6ä¸ªå­ç¬¦ç¸ç­ æä»¥å½å¹éä¸æåæ¶ ä¸ç¨åæº¯å°ä¸æ ä¸º6çä½ç½®å»ç»§ç»­å¹é
*/
